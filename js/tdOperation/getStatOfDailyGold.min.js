let c=0;let dailyTotalNumArr=[];function getDate(targetTz){let date=new Date(getTargetMilliSec(targetTz));return date.getDate()}function getTargetMilliSec(targetTz){let date=new Date();let localMilliSec=date.getTime();let utcLocalDiff=date.getTimezoneOffset();let targetUtcDiff=targetTz*60;let targetLocalDiff=utcLocalDiff+targetUtcDiff;return localMilliSec+targetLocalDiff*60000}function getTdStat(trLength,orAnd,regExpArr,breakPointColumnSerial,breakPointValue){var tr=document.getElementsByTagName("tr");var l=tr.length;var c=0;var a=[];var s="\n\n";for(let i=0;i<l;i++){let td=tr[i].getElementsByTagName("td");if(td.length===trLength){let inner=[];for(let j=0;j<trLength;j++){inner[j]=td[j].innerText}if(regJudge(trLength,orAnd,regExpArr,inner)){a[c]=[];for(let j=0;j<trLength;j++){a[c].push(inner[j])}c+=1}}if(td[breakPointColumnSerial-1]){if(td[breakPointColumnSerial-1].innerText){if(td[breakPointColumnSerial-1].innerText===breakPointValue){break}}}}if(c>0){console.table(a);console.log("\n\tThis Day Total: "+c+"\n\n");dailyTotalNumArr.push(c)}}function regJudge(trLength,orAnd,regExpArr,tarTdInnerArr){let b=true;let l=regExpArr.length;let patt=/^\/.*\/(i|(ig)|(gi)|m|g)?$/;if(l>trLength){return false}if(orAnd===0){if(l===0){return true}for(let i=0;i<regExpArr.length;i++){if(patt.test(regExpArr[i].toString())){b=false;b=b||regExpArr[i].test(tarTdInnerArr[i])}}}else if(orAnd===1){for(let i=0;i<regExpArr.length;i++){if(patt.test(regExpArr[i].toString())){b=b&&regExpArr[i].test(tarTdInnerArr[i])}}}else{b=false}return b}function getDateString(){c+=1;return c.toString().length===1?"0"+c.toString():c.toString()}function getMonthlyStat(timeZone,columnNumber,staffName,isEnd){let targetDate=isEnd!==0?31:getDate(timeZone);for(let i=0;i<targetDate;i++){getTdStat(columnNumber,1,[new RegExp(getDateString()+"-"),0,0,new RegExp(staffName,"i")])}let sum=0;for(let i=0;i<dailyTotalNumArr.length;i++){sum+=dailyTotalNumArr[i]}console.log("\n\n\tThis Month Total: "+sum);c=0;dailyTotalNumArr=[]}getMonthlyStat(-7,8,"nicole",0);