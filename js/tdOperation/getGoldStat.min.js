function getGoldStat(rn,t,s,d,a,b,st){var rowNumber=rowNumber=rn?rn:6;var tid=tid=t?t.split(' '):[];var staffName=staffName=s?s.split(' '):[];var device=device=d?d.split(' '):['p','m','i','a','u'];var date=getTarDate(-8);var d1=d1=a?a:date;var d2=d2=b?b:date;var strict=strict=st?st:0;var tr=document.getElementsByTagName('tr');var c=0;var jud=0;let objArr=[];for(let i=0;i<tr.length-1;i++){if(tr[i].getElementsByTagName('td').length!==rowNumber||tr[i].getElementsByTagName('td')[0].innerText===undefined){continue}var td1=parseInt(tr[i].getElementsByTagName('td')[0].innerText.split('-')[0]);if(td1<d1||td1>d2||isNaN(td1)){continue}var td2=tr[i].getElementsByTagName('td')[2].innerText;var pattT=[];if(tid.length!==0){for(let j=0;j<tid.length;j++){pattT[j]=new RegExp(tid[j],'i')}for(let j=0;j<pattT.length;j++){if(pattT[j].test(td2)){jud=1;break}}if(jud===0){continue}}else{jud=0}var td3=tr[i].getElementsByTagName('td')[3].innerText;var pattN=[];if(staffName.length!==0){if(strict===1){for(let j=0;j<staffName.length;j++){pattN[j]=staffName[j]}for(let j=0;j<pattN.length;j++){if(pattN[j]===td3){jud=1;break}}if(jud===0){continue}}else{for(let j=0;j<staffName.length;j++){pattN[j]=new RegExp(staffName[j],'i')}for(let j=0;j<pattN.length;j++){if(pattN[j].test(td3)){jud=1;break}}if(jud===0){continue}}}else{jud=0}var td4=tr[i].getElementsByTagName('td')[4].innerText;var deviceName=[];if(device.indexOf('p')>-1){deviceName.push('PC')}if(device.indexOf('m')>-1){deviceName.push('Mobile')}if(device.indexOf('i')>-1){deviceName.push('IOS')}if(device.indexOf('a')>-1){deviceName.push('Android')}if(device.indexOf('u')>-1){deviceName.push('UNKNOWN')}if(deviceName.indexOf(td4)>-1){jud=1}else{continue}if(jud===1){objArr[c]={"date":td1,"tid":td2,"staff name":td3,"device":td4};c+=1;jud=0}}let dayNum=d2-d1+1;let avg=0;if(dayNum<2){avg=c}else{avg=(c/dayNum).toFixed(2).toString()}console.table(objArr);console.log('\n\tTotal: '+c+'\n\n\tDaily Average: '+avg+'\n\n\tDay Number: '+dayNum+'\n\n')}function getTarDate(targetTz){let date=new Date(getTargetMilliSec(targetTz));return date.getDate()}function getTargetMilliSec(targetTz){let date=new Date();let localMilliSec=date.getTime();let utcLocalDiff=date.getTimezoneOffset();let targetUtcDiff=targetTz*60;let targetLocalDiff=utcLocalDiff+targetUtcDiff;return localMilliSec+targetLocalDiff*60000}
//getGoldStat(7,'','jonas','p m i a u',1);